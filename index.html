<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Classroom Behavior Tracker</title>
    <style>
        body { font-family: Arial; max-width: 1200px; margin: 20px auto; padding: 20px; }
        .container { background: #f0f0f0; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .section { margin-bottom: 30px; }
        .section h2 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        .input-group { margin-bottom: 15px; }
        input[type="text"] { padding: 8px; width: 200px; margin-right: 10px; }
        button { padding: 8px 16px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #2980b9; }
        .behavior-btns { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; }
        .student-columns { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .student-column { background: #fff; padding: 15px; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .student-list { list-style: none; padding: 0; }
        .student-list li { padding: 5px 0; cursor: pointer; transition: background-color 0.3s; }
        .student-list li:hover { background-color: #f5f5f5; }
        .student-list li.selected { background-color: #e8f4f8; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Period Navigation -->
        <div class="section">
            <h2>Class Periods</h2>
            <div id="periodsNav"></div>
        </div>

        <!-- Current Period Content -->
        <div id="currentPeriodContent">
            <!-- Student Management -->
            <div class="section">
                <h2>Students</h2>
                <div class="input-group">
                    <input type="text" id="studentInput" placeholder="Add student name">
                    <button onclick="addStudent()">Add Student</button>
                </div>
                <div class="student-columns" id="studentColumns"></div>
            </div>

            <!-- Behavior Tracking -->
            <div class="section">
                <h2>Track Behavior</h2>
                <div class="behavior-btns" id="behaviorButtons"></div>
                <button onclick="exportCSV()" style="margin-top: 20px;">Export Weekly Data</button>
            </div>
        </div>
    </div>

    <script>
        // Behavior categories
        const POSITIVE_BEHAVIORS = [
            'Asking deep questions',
            'Helping a peer',
            'Answering questions in class',
            'Helping class organization'
        ];
        const NEGATIVE_BEHAVIORS = [
            'On phone with incomplete work',
            'Off task on Chromebook',
            'Cheating off friend on classwork',
            'Missing materials',
            'Backpack not in place',
            'Inappropriate language',
            'Harassing others',
            'Opening door out of place',
            'No bathroom pass',
            'Incorrect bathroom pass',
            'Photo math class work',
            'Other class obstructions'
        ];

        // State management
        let periods = JSON.parse(localStorage.getItem('periods')) || [];
        let students = JSON.parse(localStorage.getItem('students')) || {};
        let behaviorLogs = JSON.parse(localStorage.getItem('behaviorLogs')) || [];
        let currentPeriod = localStorage.getItem('currentPeriod') || periods[0] || 'Period 1';
        let selectedStudent = null;

        // DOM elements
        const periodsNav = document.getElementById('periodsNav');
        const studentColumns = document.getElementById('studentColumns');
        const behaviorButtons = document.getElementById('behaviorButtons');

        // Initialize UI
        function initUI() {
            renderPeriodsNav();
            renderBehaviorButtons();
            renderStudents();
        }

        // Period management
        function addPeriod() {
            const input = document.createElement('input');
            input.type = 'text';
            input.placeholder = 'New period name';
            input.onkeypress = (e) => {
                if (e.key === 'Enter') {
                    periods.push(input.value);
                    input.value = '';
                    saveState();
                    renderPeriodsNav();
                }
            };
            periodsNav.appendChild(input);
        }

        function renderPeriodsNav() {
            periodsNav.innerHTML = `
                <button onclick="addPeriod()">Add Period</button>
                ${periods.map(p => `
                    <button onclick="switchPeriod('${p}')">${p}</button>
                `).join('')}
            `;
        }

        function switchPeriod(periodName) {
            currentPeriod = periodName;
            localStorage.setItem('currentPeriod', currentPeriod);
            renderStudents();
        }

        // Student management
        function addStudent() {
            const input = document.getElementById('studentInput');
            if (input.value.trim()) {
                if (!students[currentPeriod]) students[currentPeriod] = [];
                students[currentPeriod].push(input.value);
                input.value = '';
                saveState();
                renderStudents();
            }
        }

        function renderStudents() {
            const studentsList = students[currentPeriod] || [];
            const sortedStudents = [...studentsList].sort();
            const columns = [];
            const columnCount = Math.ceil(sortedStudents.length / 10);

            for (let i = 0; i < columnCount; i++) {
                const start = i * 10;
                const end = start + 10;
                columns.push(sortedStudents.slice(start, end));
            }

            studentColumns.innerHTML = columns.map((col, i) => `
                <div class="student-column">
                    <h3>Column ${i + 1}</h3>
                    <ul class="student-list">
                        ${col.map(s => `
                            <li onclick="selectStudent('${s}')">${s}</li>
                        `).join('')}
                    </ul>
                </div>
            `).join('');
        }

        // Student selection
        function selectStudent(studentName) {
            selectedStudent = studentName;
            document.querySelectorAll('.student-list li').forEach(li => {
                li.style.backgroundColor = li.textContent === studentName ? '#e8f4f8' : '';
            });
        }

        // Behavior tracking
        function renderBehaviorButtons() {
            behaviorButtons.innerHTML = [...POSITIVE_BEHAVIORS, ...NEGATIVE_BEHAVIORS].map(b => `
                <button onclick="logBehavior('${b}')">${b}</button>
            `).join('');
        }

        function logBehavior(behavior) {
            if (!selectedStudent) {
                alert("Please select a student first!");
                return;
            }
            
            const log = {
                period: currentPeriod,
                student: selectedStudent,
                behavior,
                timestamp: new Date().toISOString(),
                category: POSITIVE_BEHAVIORS.includes(behavior) ? 'positive' : 'negative'
            };
            behaviorLogs.push(log);
            saveState();
        }

        // Export to CSV
        function exportCSV() {
            const csvContent = [
                ['Period', 'Student', 'Behavior', 'Date', 'Category'],
                ...behaviorLogs.map(log => [
                    log.period,
                    log.student,
                    log.behavior,
                    log.timestamp.split('T')[0],
                    log.category
                ])
            ].map(row => row.join(',')).join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `behavior-export-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Save state to localStorage
        function saveState() {
            localStorage.setItem('periods', JSON.stringify(periods));
            localStorage.setItem('students', JSON.stringify(students));
            localStorage.setItem('behaviorLogs', JSON.stringify(behaviorLogs));
            localStorage.setItem('currentPeriod', currentPeriod);
        }

        // Initialize app
        initUI();
        window.addEventListener('beforeunload', saveState);
    </script>
</body>
</html>
